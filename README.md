# Проект "Прогнозирование температуры звезды"

## Описание проекта

Предоставлен набор данных о звездах. Имеются следующие их 6 характеристик:
- **Temperature (K)**. Абсолютная температура в Кельвинах. ***Целевой показатель***;
- **Luminosity(L/Lo)**. Светимость звезды относительно Солнца;
- **Radius(R/Ro)**. Радиус звезды относительно радиуса Солнца;
- **Absolute magnitude(Mv)**. Физическая величина, характеризующая блеск звезды;
- **Star color**. Цвет звезды, определяемый на основе спектрального анализа;
- **Star type**. Тип звезды.

Метрика данного проекта - **RMSE**. Необходимые значения данного показатель - **менее 4 500**.

## Типы звезд (параметр *Star type*)

- 0 - Коричневый карлик;
- 1 - Красный карлик;
- 2 - Белый карлик;
- 3 - Звезды главной последовательности;
- 4 - Сверхгигант;
- 5 - Гипергигант.

<br>В рамках данного проекта необходимо предсказать абсолютную температуру на поверхности звезды в Кельвинах. Существуют различные способы определения абсолютной температуры на поверхности звезды, но заказчик, Обсерватори, надеется, что технологии машинного обучения помогут определить температуру точнее.

## План работы

1. [Импортирование библиотек и файлов](#import)
2. [Предобработка и анализ данных](#preprocessing)
    - [Общие характеристики](#general)
    - [Предобработка отдельных параметров](#parameters)
        - [color](#color)
        - [type](#type)
    - [Исследовательский анализ анализ данных](#eda)
        - [Корреляция светимости звезд от их температуры](#l_t_ratio)
        - [Корреляция типа звезды и температуры](#t_t_ratio)
        - [Корреляция между цветом звезды и температурой](#c_t_ratio)
        - [Корреляция между радиусом звезды и температурой](#r_t_ratio)
        - [Корреляция между абсолютной звездной величиной и температурой ](#m_t_ratio)
        - [Корреляция между абсолютной звездной величиной и типом](#mv_t_ratio)
    - [Корреляция phik](#phik_corr)
    - [Заключения по исследовательскому анализу данных](#eda_conclusions)
3. [Подготовка данных к построению модели](#data_preparation)
4. [Построение базовой нейронной сети](#nn_creation)
    - [Инициализация необходимых функций](#necessary_functions)
    - [Создание базовой нейронной сети](#basic_nn)
5. [Улучшение нейронной сети](#nn_improvement)
    - [Использование батчей](#batch_usage)
    - [Batch Normalization](#batch_norm)
    - [Dropout](#dropout)
6. [Выводы](#conclusion)

## Решенные задачи

1. Осуществлена предобработка данных;
2. Проведен исследовательский анализ данных - поиск наибольших корреляций между параметрами базы данных. Наибольшие коэффициенты корреляции обнаружены между целевым показателем - ***температурой*** и следующими параметрами: абсолютной звездной величиной (0.71) и цветов (0.68). В целом наибольшая взаимосвязь наблюдается между абсолютной звездной величиной и типом звезды - 0.92.
3. Создана базовая модель нейронной сети. Осуществлено тестирование и обучение нейронной сети. Достигнуто следующее значение метрики RMSE - **около 4 350**. Параметры базовой нейронной сети:
   	- Количество входных нейронов - количество независимых переменных (17);
	- Количество скрытых слоев - 2. Количество слоев на каждом слое:
     	- 1 слой - 8 нейронов;
     	- 2 слой - 5 нейронов.
	- Количество нейронов в выходном слое - 1;
   	- Функции активации - LeakyReLU;
	- Оптимизатор - Адам. Скорость обучения - 2e-3;
	- Инициализация весов - инициализация Кайминга.
 	- Количество эпох - 8 001;
	- Тестирование модели - каждые 1000 эпох.
5. Реализованы иные модели нейронной сети с той же архитектурой, что и базовая, но с изменениями:
   - С использованием батчей при обучении;
   - С осуществлением нормализации батчей;
   - С "выключение" нейройнов - Dropout.
   - С изменением количества эпох и периодичностью тестирования модели;
   - С изменением скорости обучения (learning rate).
6. Наилучшее значение метрики RMSE продемонстрировала **нейронная сеть с осуществлением нормализации батчей**. Ее параметры:
   - Количество эпох - 5 001;
   - Тестирование модели - каждые 500 эпох.
   - Скорость обучения - 1e-3.
   - RMSE - 4 053.
7. Рекомендовано использование **нейронной сети с осуществлением нормализации батчей** поскольку ее метрика ниже, а ресурсы на обучение и тестирование не столь значительны в отличие от **базовой нейронной сети**.

<hr> 

График значений RMSE с предсказанными значениями **нейронной сети с нормализацией батчей**:

![image](https://github.com/Midle68/first_nn/assets/88423574/550c1d7b-12a0-4acd-a0af-dae0de2ebd8b)

График значений RMSE с предсказанными значениями **базовой нейронной сети**:

![image](https://github.com/Midle68/first_nn/assets/88423574/6d12bc73-9fee-4ff2-b5cb-3dbc70df6747)

## Использованные библиотеки
`math`, `matplotlib`, `numpy` `pandas`, `torch`, `phik`, `sklearn`
